<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate Age-Standardised Rates with Confidence Intervals — calculate_asr_direct • epiUtils</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate Age-Standardised Rates with Confidence Intervals — calculate_asr_direct"><meta name="description" content="This function calculates age-standardised rates using the direct
standardisation method with confidence intervals. It can be used for both
incidence rates (events over time) and prevalence rates (cross-sectional
data). The gamma method is preferred for confidence intervals as it naturally
prevents negative bounds and is the standard approach in epidemiological
literature."><meta property="og:description" content="This function calculates age-standardised rates using the direct
standardisation method with confidence intervals. It can be used for both
incidence rates (events over time) and prevalence rates (cross-sectional
data). The gamma method is preferred for confidence intervals as it naturally
prevents negative bounds and is the standard approach in epidemiological
literature."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">epiUtils</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/epiUtils.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rmgpanw/epiUtils/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Calculate Age-Standardised Rates with Confidence Intervals</h1>
      <small class="dont-index">Source: <a href="https://github.com/rmgpanw/epiUtils/blob/main/R/calculate_asr_direct.R" class="external-link"><code>R/calculate_asr_direct.R</code></a></small>
      <div class="d-none name"><code>calculate_asr_direct.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function calculates age-standardised rates using the direct
standardisation method with confidence intervals. It can be used for both
incidence rates (events over time) and prevalence rates (cross-sectional
data). The gamma method is preferred for confidence intervals as it naturally
prevents negative bounds and is the standard approach in epidemiological
literature.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">calculate_asr_direct</span><span class="op">(</span></span>
<span>  <span class="va">.df</span>,</span>
<span>  conf_level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  multiplier <span class="op">=</span> <span class="fl">1e+05</span>,</span>
<span>  ci_method <span class="op">=</span> <span class="st">"gamma"</span>,</span>
<span>  warn_small_cases <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg--df">.df<a class="anchor" aria-label="anchor" href="#arg--df"></a></dt>
<dd><p>A data frame containing age-specific case counts, population data,
and standard population weights. Must contain the following columns:</p><ul><li><p><strong>age_group</strong>: Age group labels</p></li>
<li><p><strong>events</strong>: Number of events/cases in each age group (integer). For incidence:
new cases over time. For prevalence: individuals with condition at a point in time.</p></li>
<li><p><strong>person_years</strong>: Person-years of follow-up (incidence) or population size
(prevalence) in each age group (numeric). For prevalence studies, use the
total number of individuals examined/surveyed.</p></li>
<li><p><strong>standard_pop</strong>: Standard population weights for each age group (numeric)</p></li>
</ul></dd>


<dt id="arg-conf-level">conf_level<a class="anchor" aria-label="anchor" href="#arg-conf-level"></a></dt>
<dd><p>Confidence level for confidence intervals (default: 0.95)</p></dd>


<dt id="arg-multiplier">multiplier<a class="anchor" aria-label="anchor" href="#arg-multiplier"></a></dt>
<dd><p>Multiplier for rate expression (default: 100000 for rates
per 100,000). Use 100 for prevalence studies to express results as percentages.</p></dd>


<dt id="arg-ci-method">ci_method<a class="anchor" aria-label="anchor" href="#arg-ci-method"></a></dt>
<dd><p>Character string specifying the confidence interval
calculation method. Options are "gamma" (default) or "byars". The gamma
method uses the gamma distribution approach (consistent with
<a href="https://CRAN.R-project.org/package=epitools" class="external-link">epitools</a>), while the Byar's
method uses Byar's approximation with Dobson adjustment (consistent with
<a href="https://CRAN.R-project.org/package=PHEindicatormethods" class="external-link">PHEindicatormethods</a>).
Both methods are statistically valid; differences are typically minimal.</p></dd>


<dt id="arg-warn-small-cases">warn_small_cases<a class="anchor" aria-label="anchor" href="#arg-warn-small-cases"></a></dt>
<dd><p>Logical. If TRUE (default), warns when age groups
have zero or &lt; 5 cases which may lead to unstable rate estimates. Consider
wider age groups for more stable results.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A tibble containing:</p><ul><li><p><strong>crude_rate</strong>: Crude incidence rate</p></li>
<li><p><strong>crude_rate_scaled</strong>: Crude rate multiplied by multiplier</p></li>
<li><p><strong>asr</strong>: Age-standardised incidence rate</p></li>
<li><p><strong>asr_scaled</strong>: ASR multiplied by multiplier</p></li>
<li><p><strong>ci_lower</strong>: Lower confidence interval bound for ASR</p></li>
<li><p><strong>ci_upper</strong>: Upper confidence interval bound for ASR</p></li>
<li><p><strong>ci_lower_scaled</strong>: Lower CI multiplied by multiplier</p></li>
<li><p><strong>ci_upper_scaled</strong>: Upper CI multiplied by multiplier</p></li>
<li><p><strong>conf_level</strong>: Confidence level used</p></li>
<li><p><strong>total_events</strong>: Total number of events across all age groups</p></li>
<li><p><strong>total_person_years</strong>: Total person-years across all age groups</p></li>
<li><p><strong>age_specific_data</strong>: Data frame with age-specific rates and details</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function uses the gamma distribution method for confidence
interval calculation, which is the standard approach in epidemiological
software like epitools. This method naturally prevents negative confidence
interval bounds and is appropriate for rate data.</p>
<p>The direct standardisation method calculates ASR as: ASR = Σ(w_i × r_i)
where w_i are standardised weights and r_i are age-specific rates</p>
<p><strong>Incidence vs Prevalence:</strong></p><ul><li><p><strong>Incidence rates</strong>: Use person-years of follow-up in denominator, typically expressed per 100,000</p></li>
<li><p><strong>Prevalence rates</strong>: Use total individuals examined in denominator, typically expressed as percentages (set multiplier = 100)</p></li>
</ul><p><strong>Age Grouping Considerations:</strong></p><ul><li><p>Zero cases are allowed but may indicate very low incidence or small populations</p></li>
<li><p>Age groups with &lt; 5 cases produce less stable rate estimates and wider confidence intervals</p></li>
<li><p>Consider wider age groups if many strata have very few cases</p></li>
<li><p>All age groups must have positive person-years (mathematical requirement)</p></li>
<li><p>The function balances statistical stability with age-specific precision</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Breslow, N. E., &amp; Day, N. E. (1987). Statistical methods in
cancer research. Volume II–The design and analysis of cohort studies. IARC
scientific publications, (82), 1-406.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Example 1: Incidence rates (per 100,000)</span></span></span>
<span class="r-in"><span><span class="va">incidence_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  age_group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0-19"</span>, <span class="st">"20-39"</span>, <span class="st">"40-59"</span>, <span class="st">"60-79"</span>, <span class="st">"80+"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  events <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5L</span>, <span class="fl">25L</span>, <span class="fl">150L</span>, <span class="fl">300L</span>, <span class="fl">80L</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  person_years <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20000</span>, <span class="fl">25000</span>, <span class="fl">22000</span>, <span class="fl">15000</span>, <span class="fl">3000</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  standard_pop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">35000</span>, <span class="fl">25000</span>, <span class="fl">20000</span>, <span class="fl">15000</span>, <span class="fl">5000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate age-standardised incidence rate</span></span></span>
<span class="r-in"><span><span class="va">incidence_result</span> <span class="op">&lt;-</span> <span class="fu">calculate_asr_direct</span><span class="op">(</span>.df <span class="op">=</span> <span class="va">incidence_data</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">incidence_result</span><span class="op">$</span><span class="va">asr_scaled</span><span class="op">)</span>  <span class="co"># ASR per 100,000</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 603.447</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 2: Prevalence rates (as percentages)</span></span></span>
<span class="r-in"><span><span class="va">prevalence_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  age_group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"18-29"</span>, <span class="st">"30-49"</span>, <span class="st">"50-69"</span>, <span class="st">"70+"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  events <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12L</span>, <span class="fl">45L</span>, <span class="fl">98L</span>, <span class="fl">67L</span><span class="op">)</span>,  <span class="co"># Individuals with condition</span></span></span>
<span class="r-in"><span>  person_years <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1200</span>, <span class="fl">1500</span>, <span class="fl">1400</span>, <span class="fl">800</span><span class="op">)</span>,  <span class="co"># Individuals surveyed</span></span></span>
<span class="r-in"><span>  standard_pop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2435</span>, <span class="fl">3847</span>, <span class="fl">2603</span>, <span class="fl">763</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate age-standardised prevalence (use multiplier = 100 for percentages)</span></span></span>
<span class="r-in"><span><span class="va">prevalence_result</span> <span class="op">&lt;-</span> <span class="fu">calculate_asr_direct</span><span class="op">(</span>.df <span class="op">=</span> <span class="va">prevalence_data</span>, multiplier <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Prevalence:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">prevalence_result</span><span class="op">$</span><span class="va">asr_scaled</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"%"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Prevalence: 4 %"</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alasdair Warwick.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

